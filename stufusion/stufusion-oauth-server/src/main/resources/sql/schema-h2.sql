
DROP TABLE IF EXISTS `users`;

CREATE TABLE `users` (
  `ID`  BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 100, INCREMENT BY 1) PRIMARY KEY,
  `PASSWORD` varchar(120) DEFAULT NULL,
  `ENABLED` BIT NOT NULL DEFAULT '0',
  `FIRST_NAME` varchar(100) DEFAULT NULL,
  `LAST_NAME` varchar(100) DEFAULT NULL,
  `EMAIL` varchar(100) DEFAULT NULL,
  `USERJSON` text DEFAULT NULL,
  `USERID` varchar(50) DEFAULT NULL,
  `USERTYPE` varchar(20) DEFAULT NULL,
   PRIMARY KEY (`ID`),
);

DROP TABLE IF EXISTS `permissions`;

CREATE TABLE `permissions` (
  `ID` BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 100, INCREMENT BY 1) PRIMARY KEY,
  `PERMISSIONNAME` varchar(50) NOT NULL,
  UNIQUE KEY `PERMISSIONNAME` (`PERMISSIONNAME`)
);

DROP TABLE IF EXISTS `roles`;

CREATE TABLE `roles` (
  `ID` BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 100, INCREMENT BY 1) PRIMARY KEY,
  `ROLENAME` varchar(50) NOT NULL,
  PRIMARY KEY (`ID`),
  UNIQUE KEY `ROLENAME` (`ROLENAME`)
);


DROP TABLE IF EXISTS `role_permissions`;

CREATE TABLE `role_permissions` (
  `ROLE_ID` BIGINT NOT NULL,
  `PERMISSION_ID` BIGINT NOT NULL,
  CONSTRAINT `role_permissions_ibfk_1` FOREIGN KEY (`ROLE_ID`) REFERENCES `roles` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `role_permissions_ibfk_2` FOREIGN KEY (`PERMISSION_ID`) REFERENCES `permissions` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE
);

DROP TABLE IF EXISTS `user_roles`;

CREATE TABLE `user_roles` (
  `USER_ID` BIGINT NOT NULL,
  `ROLE_ID` BIGINT NOT NULL,
  CONSTRAINT `userrole_user_id_fk1` FOREIGN KEY (`ROLE_ID`) REFERENCES `roles` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `userrole_role_id_fk2` FOREIGN KEY (`USER_ID`) REFERENCES `users` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE
);

DROP TABLE IF EXISTS `verification_token`;

CREATE TABLE `verification_token` (
  `ID`  BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 100, INCREMENT BY 1) PRIMARY KEY,
  `TOKEN` varchar(120) NOT NULL,
  `USER_ID` BIGINT NOT NULL,
  `EXPIRY_DATE` TIMESTAMP NOT NULL,
   PRIMARY KEY (`ID`),
   CONSTRAINT `verification_token_user_id_fk1` FOREIGN KEY (`USER_ID`) REFERENCES `users` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE `user_auth_provider` (
  `ID`  BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 100, INCREMENT BY 1) PRIMARY KEY,
  `AUTHPROVIDERTYPE` varchar(120) NOT NULL,
  `AUTHPROVIDER_ID` varchar(120) NOT NULL,
  `USER_ID` BIGINT NOT NULL,
   PRIMARY KEY (`ID`),
   CONSTRAINT `user_auth_provider_id_fk1` FOREIGN KEY (`USER_ID`) REFERENCES `users` (`ID`) ON DELETE CASCADE ON UPDATE CASCADE
);

-- Client Details SQL https://github.com/spring-projects/spring-security-oauth/blob/master/spring-security-oauth2/src/test/resources/schema.sql
